var Te=Object.defineProperty,He=Object.defineProperties;var Me=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var je=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable;var we=(c,o,r)=>o in c?Te(c,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[o]=r,v=(c,o)=>{for(var r in o||(o={}))je.call(o,r)&&we(c,r,o[r]);if(se)for(var r of se(o))ye.call(o,r)&&we(c,r,o[r]);return c},w=(c,o)=>He(c,Me(o));var Ce=(c,o)=>{var r={};for(var g in c)je.call(c,g)&&o.indexOf(g)<0&&(r[g]=c[g]);if(c!=null&&se)for(var g of se(c))o.indexOf(g)<0&&ye.call(c,g)&&(r[g]=c[g]);return r};var A=(c,o,r)=>new Promise((g,k)=>{var S=j=>{try{D(r.next(j))}catch(p){k(p)}},P=j=>{try{D(r.throw(j))}catch(p){k(p)}},D=j=>j.done?g(j.value):Promise.resolve(j.value).then(S,P);D((r=r.apply(c,o)).next())});import{j as e,r as h,u as _e,k as ze,M as Be}from"./index-0nKeV5mV.js";import{B as $,Y as L,Q as Ae}from"./react-toastify.esm-Dgz2zfA7.js";import"./PDFButton-Z4hNujZT.js";import{B as Ne,P as Fe}from"./BlankPDF-CpqlvkOA.js";import{p as Pe,s as Re}from"./GetPages-DZ2Unb46.js";import{u as Ie,b as Ue,a as We}from"./ButtonUtilities-CIrU2kmJ.js";import{R as $e,e as Le}from"./extractUniqueElements-DoaRpADM.js";import{M as Ve}from"./index-gDlXHgX-.js";import{T as ke}from"./index-BHP3nk3e.js";import{S as Je}from"./index-dNSh_puv.js";import{d as ue}from"./dayjsConfig-DOSRkPgf.js";import"./PurePanel-BDIKaUYK.js";import"./index-gXNO_Cjl.js";import"./SearchOutlined-DWH8I_Xr.js";function Se(g){var k=g,{color:c="currentColor",size:o="1em"}=k,r=Ce(k,["color","size"]);return e.jsxs("svg",w(v({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:o,height:o,fill:c},r),{children:[e.jsx("path",{fill:"currentColor",d:"M2.75 6.167c0-.46.345-.834.771-.834h2.665c.529-.015.996-.378 1.176-.916l.03-.095l.115-.372c.07-.228.131-.427.217-.605c.338-.702.964-1.189 1.687-1.314c.184-.031.377-.031.6-.031h3.478c.223 0 .417 0 .6.031c.723.125 1.35.612 1.687 1.314c.086.178.147.377.217.605l.115.372l.03.095c.18.538.74.902 1.27.916h2.57c.427 0 .772.373.772.834S20.405 7 19.979 7H3.52c-.426 0-.771-.373-.771-.833"}),e.jsx("path",{fill:"currentColor",d:"M11.607 22h.787c2.707 0 4.06 0 4.941-.863c.88-.864.97-2.28 1.15-5.111l.26-4.081c.098-1.537.147-2.305-.295-2.792s-1.187-.487-2.679-.487H8.23c-1.491 0-2.237 0-2.679.487s-.392 1.255-.295 2.792l.26 4.08c.18 2.833.27 4.248 1.15 5.112S8.9 22 11.607 22",opacity:".5"})]}))}function Ye({owner_email:c,assigned_user:o,template_tite:r,document_title:g,setTarget:k,onClickSaveDoc:S}){const{TabPane:P}=ke,[D,j]=h.useState(!1),[p,y]=h.useState({}),[_,M]=h.useState(""),[z,d]=h.useState(`${g}-(${r})`),[O,V]=h.useState(""),[N,me]=h.useState(1),[J,Y]=h.useState(!1),[q,Q]=h.useState(""),[ae,f]=h.useState([]),[xe,K]=h.useState(!0),[R,G]=h.useState(""),[F,X]=h.useState([]),re=()=>{R&&![...Object.values(p),...F].some(l=>l.email===R)&&(X([...F,{email:R}]),G(""))};function I(l,m){const C=Object.values(l).map(H=>({email:H.email})),T=m.map(H=>typeof H=="string"?{email:H}:{email:H.email}),U=[...C,...T],te={};return U.forEach((H,ce)=>{te[ce]=H}),te}const ie=l=>{X(F.filter(m=>m.email!==l))};h.useEffect(()=>{z&&O&&Object.keys(p).length>0?Y(!0):Y(!1)},[_,z,O,p]);const ne=_e();h.useEffect(()=>{const l=o.reduce((m,C,T)=>(m[T]={email:C,status:"unseen"},m),{});y(l)},[o]),h.useEffect(()=>{A(this,null,function*(){try{const m=yield fetch('/api/resource/Email Template?fields=["name"]');if(!m.ok)throw new Error("Failed to fetch email templates");const C=yield m.json();f(C.data)}catch(m){console.error("Error fetching email templates:",m)}finally{K(!1)}})},[]);const Z=()=>{if(_&&!Object.values(p).some(l=>l.email===_)){const l=Object.keys(p).length;y(w(v({},p),{[l]:{email:_,status:"unseen"}})),M("")}},le=()=>A(this,null,function*(){try{const l=yield fetch("/api/method/frappe.email.doctype.email_template.email_template.get_email_template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template_name:q,doc:{}})});if(!l.ok)throw new Error("Failed to fetch email template");const m=yield l.json();d(m.message.subject),V(m.message.message)}catch(l){console.error("Error fetching email template:",l)}}),oe=l=>{const m=Object.keys(p).filter(C=>p[parseInt(C)].email!==l).reduce((C,T,U)=>(C[U]=p[parseInt(T)],C),{});y(m)},ee=()=>{k(null),j(!0)},de=()=>A(this,null,function*(){j(!1);const l=I(p,F),m={to:JSON.stringify(p,null,2),mailUsers:JSON.stringify(l,null,2),subject:z,body:O,document_name:g,user_mail:c,isChecked:N};try{(yield(yield fetch("/api/method/esign_app.api.send_document_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)})).json()).message.status<300?(S(),$.success("Document Assigned Successfully",{position:"top-right",autoClose:500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:L}),setTimeout(()=>{ne("/documents")},2e3)):$.error("Error While Sending Document...",{position:"top-right",autoClose:500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:L})}catch(C){$.error("Server Error, Please Try Again...",{position:"top-right",autoClose:500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:L})}});return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"bg-[#283C42] text-white px-4 py-2 rounded border-2 border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300",onClick:ee,children:"Send Document"}),e.jsx(Ve,{title:"Send Document",open:D,onCancel:()=>j(!1),footer:null,width:"60vw",rootClassName:"glass-modal",children:e.jsx("div",{children:e.jsxs(ke,{defaultActiveKey:"1",className:"[&_.ant-tabs-tab]:text-white",children:[e.jsx(P,{tab:"Compose",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"From:"}),e.jsx("input",{type:"email",value:c,disabled:!0,className:"w-full px-3 py-2 rounded bg-white/10 text-white text-xs border border-white/10 cursor-not-allowed backdrop-blur-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"To:"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"email",placeholder:"Add email",value:_,onChange:l=>M(l.target.value),className:"w-full px-3 py-2 rounded bg-white/10 text-white text-xs border border-white/10 backdrop-blur-sm"}),e.jsx("button",{type:"button",onClick:Z,className:"bg-white/20 text-white px-3 py-2 rounded text-xs font-semibold border border-white/10 backdrop-blur-sm hover:bg-white/30",children:"Add"})]}),e.jsx("div",{className:"mt-3 max-h-24 overflow-y-auto",children:e.jsx("ul",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:Object.keys(p).map(l=>e.jsxs("li",{className:"flex justify-between items-center bg-white/10 text-white text-xs px-3 py-2 rounded border border-white/10 backdrop-blur-sm",children:[e.jsx("span",{className:"truncate",children:p[parseInt(l)].email}),e.jsx("button",{type:"button",onClick:()=>oe(p[parseInt(l)].email),className:"text-red-400 text-xs font-semibold hover:text-red-500",children:e.jsx(Se,{size:"1.2em",color:"red"})})]},l))})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold mb-1 text-white",children:"Select Template:"}),e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx(Je,{showSearch:!0,value:q,onChange:l=>Q(l),filterOption:(l,m)=>m?m.label.toLowerCase().includes(l.toLowerCase()):!1,options:ae.map(l=>({label:l.name,value:l.name})),className:"flex-1 glass-select"}),e.jsx("button",{type:"button",onClick:le,className:"bg-white/20 text-white px-4 py-2 rounded text-xs border border-white/10 backdrop-blur-sm hover:bg-white/30",children:"Load Template"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"Title:"}),e.jsx("input",{type:"text",value:z,onChange:l=>d(l.target.value),className:"w-full px-3 py-2 bg-white/10 text-white text-xs border border-white/10 backdrop-blur-sm rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"Description:"}),e.jsx("div",{className:"bg-white/10 text-white p-2 rounded border border-white/10 backdrop-blur-sm",children:e.jsx($e,{theme:"snow",value:O,onChange:V})})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("button",{type:"submit",onClick:de,className:`bg-white/20 text-white px-4 py-2 rounded-md font-semibold text-xs border border-white/10 backdrop-blur-sm hover:bg-white/30 ${J?"cursor-pointer":"cursor-not-allowed opacity-60"}`,disabled:!J,children:"Send"})})]})},"1"),e.jsx(P,{tab:"Manage Emails",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"Add More Emails:"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"email",placeholder:"Enter email",value:R,onChange:l=>G(l.target.value),className:"w-full px-3 py-2 rounded bg-white/10 text-white text-xs border border-white/10 backdrop-blur-sm"}),e.jsx("button",{type:"button",onClick:re,className:"bg-white/20 text-white px-3 py-2 rounded text-xs font-semibold border border-white/10 backdrop-blur-sm hover:bg-white/30",children:"Add"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"All Emails:"}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:e.jsx("ul",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:[...Object.values(p),...F].map((l,m)=>e.jsxs("li",{className:"flex justify-between items-center bg-white/10 text-white text-xs px-3 py-2 rounded border border-white/10 backdrop-blur-sm",children:[e.jsx("span",{className:"truncate",children:l.email}),e.jsx("button",{type:"button",onClick:()=>ie(l.email),className:"text-red-400 hover:text-red-500 font-semibold",children:e.jsx(Se,{size:"1.2em",color:"currentColor"})})]},m))})})]})]})},"2")]})})})]})}const dt=()=>{var ge,be,fe,ve;const[c,o]=h.useState([]),[r,g]=h.useState(null),[k,S]=h.useState(null),[P,D]=h.useState(""),[j,p]=h.useState(""),[y,_]=h.useState(0);h.useState(null);const[M,z]=h.useState(Ne),[d,O]=h.useState(null),V=h.useRef(null),N=h.useRef(null),me=h.useRef(null),J=ze(),[Y,q]=h.useState(null),[Q,ae]=h.useState([]),{documentData:f}=J.state||{},xe=_e();if(!f)return e.jsx("p",{children:"Document not found"});h.useEffect(()=>{var t;if(r!==null){const s=c.find(a=>a.id===r);O(s?{id:s.id,type:s.type,checked:(t=s.checked)!=null?t:!1,content:s.content}:null)}},[r,k,c]),h.useEffect(()=>{A(void 0,null,function*(){try{const a=yield(yield fetch(`/api/method/esign_app.api.get_document_components_and_basepdf?document_name=${f?f.name:""}`)).json();if(a.message.document_json_data==null||a.message.base_pdf_datad==null)return;if(a.message.status===200){const i=typeof a.message.document_json_data=="string"?JSON.parse(a.message.document_json_data):a.message.document_json_data,n=typeof a.message.base_pdf_datad=="string"?JSON.parse(a.message.base_pdf_datad):a.message.base_pdf_datad;o(i),z(n)}}catch(s){console.error("Error:",s)}}),K()},[]);const K=()=>{const t=Le(c);ae(t)};h.useEffect(()=>{K()},[c]);const R={name:"editable",props:[],events:[],render(t,s){const a=t.getRect(),{pos2:i}=t.state,n=t.useCSS("div",`
        {
            position: absolute;
            left: 0px;
            top: 0px;
            will-change: transform;
            transform-origin: 0px 0px;
        }
        .custom-button {
            width: 24px;
            height: 24px;
            margin-bottom: 4px;
            background: #283C42;
            border-radius: 4px;
            appearance: none;
            border: 0;
            color: white;
            font-weight: bold;
        }
            `);return e.jsxs(n,{className:"moveable-editable",style:{transform:`translate(${i[0]}px, ${i[1]}px) rotate(${a.rotation}deg) translate(10px)`},children:[e.jsx("button",{className:"w-6 h-6 mb-1 p-1 bg-[#283C42] rounded border-none text-white font-bold",onClick:U,children:e.jsx("svg",{viewBox:"0 0 1024 1024",fill:"currentColor",height:"1em",width:"1em",children:e.jsx("path",{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"})})}),e.jsx("button",{className:"w-6 h-6 mb-1 p-1 bg-[#283C42] rounded border-none text-white font-bold",onClick:()=>{r!==null?ce(r):D("")},children:e.jsxs("svg",{viewBox:"0 0 1024 1024",fill:"currentColor",height:"1em",width:"1em",children:[e.jsx("defs",{children:e.jsx("style",{})}),e.jsx("path",{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6c-.3 1.5-.4 3-.4 4.4 0 14.4 11.6 26 26 26h723c1.5 0 3-.1 4.4-.4 14.2-2.4 23.7-15.9 21.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"})]})})]},"editable-viewer")}},G=()=>{y<M.length-1&&(_(y+1),S(null),g(null))},F=()=>{y>0&&(_(y-1),S(null),g(null))},X=t=>{p(t.target.value)},re=()=>{r!==null&&j.trim()!==""&&(o(t=>t.map(s=>s.id===r?w(v({},s),{assign:[...s.assign||[],j]}):s)),p(""))},I=(t,s)=>{const{type:a,value:i,files:n}=t.target;o(u=>u.map(x=>{if(x.id!==s)return x;switch(x.type){case"text":return w(v({},x),{content:i,value:i});case"image":case"v_image":if(n&&n[0]){const b=new FileReader;b.onloadend=()=>{o(E=>E.map(B=>B.id===s?w(v({},B),{content:b.result}):B))},b.readAsDataURL(n[0])}return x;case"checkbox":return w(v({},x),{checked:t.target.checked});case"m_date":case"live_date":case"fix_date":return w(v({},x),{content:i});default:return x}}))},ie=t=>{r!==null&&o(s=>s.map(a=>a.id===r?w(v({},a),{assign:(a.assign||[]).filter(i=>i!==t)}):a))};function ne(...t){return s=>{t.forEach(a=>{typeof a=="function"?a(s):a&&"current"in a&&(a.current=s)})}}const Z=(t,s)=>{const a=t.target.value;o(i=>i.map(n=>n.id===s?w(v({},n),{content:a,value:a}):n))},le=({type:t,onClick:s,children:a,title:i})=>{const[{isDragging:n},u]=We(()=>({type:"component",item:{type:t},collect:E=>({isDragging:!!E.isDragging()})}),[t]),[x,b]=h.useState(!1);return e.jsx("div",{className:"relative inline-block",onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1),children:e.jsx("button",{ref:u,className:`flex justify-center items-center w-[100%] h-[50px] bg-[#283C42] text-white px-4 py-2 cursor-grab rounded border-2 border-transparent transition-transform duration-500 ease-in-out ${n?"shiny-button":""}`,onClick:s,children:e.jsx("div",{className:"relative w-full h-full flex items-center justify-center",children:e.jsxs("div",{className:`flip-container ${x?"hovered":""}`,children:[e.jsx("div",{className:"flip-front",children:a}),e.jsx("div",{className:"flip-back",children:e.jsx("span",{children:i})})]})})})})},[,oe]=Ie(()=>({accept:"component",drop:(t,s)=>{const a=s.getClientOffset();if(N.current&&a){const i=N.current.getBoundingClientRect(),n={top:a.y-i.top-20,left:a.x-i.left-50};_(u=>(console.log(u,"WWWWWW"),ee(t.type,n,u),u))}}})),ee=(t,s,a)=>{const i={text:{width:100,height:30},v_text:{width:100,height:30},signature:{width:100,height:50},v_signature:{width:100,height:50},image:{width:80,height:80},v_image:{width:80,height:80},checkbox:{width:30,height:30},m_date:{width:100,height:30},live_date:{width:100,height:30},fix_date:{width:100,height:30}},n={id:Date.now(),type:t,pageNo:a,name:`${t}-${Date.now()}`,position:s,size:i[t]||{width:0,height:0},fontSize:t==="text"?14:void 0,value:"",assign:[],content:t==="text"?"":void 0,checked:!1};o(u=>[...u,n])},de=(t,s,a)=>{o(i=>i.map(n=>n.id===t?w(v({},n),{position:{top:s,left:a}}):n))},l=(t,s,a)=>{o(i=>i.map(n=>n.id===t?w(v({},n),{size:{width:s,height:a}}):n))},m=t=>{const s=t.target.value;D(s),r!==null&&o(a=>a.map(i=>i.id===r?w(v({},i),{content:s,value:s}):i))},C=t=>{t.target.closest(".component")||(g(null),S(null))},T=t=>{r!==null&&o(s=>s.map(a=>a.id===r?w(v({},a),{fontSize:(a.fontSize||16)+(t?2:-2)}):a))},U=()=>{r!==null&&(o(t=>t.filter(s=>s.id!==r)),g(null),S(null))},te=()=>A(void 0,null,function*(){try{_(0),o([]),z(Ne)}catch(t){console.error("Error loading data:",t)}}),H=t=>A(void 0,null,function*(){var a;const s=(a=t.target.files)==null?void 0:a[0];if(s){const i=yield Pe(s),n=yield Re(i);z(n),q(s?s.name:null),_(0)}});h.useEffect(()=>{if(r!==null){const t=document.querySelector(`[data-id="${r}"]`);S(t);const s=c.find(a=>a.id===r);(s==null?void 0:s.type)==="text"&&D(s.content||"")}},[r,c]),h.useEffect(()=>{if(r!==null){const t=c.find(s=>s.id===r);O(t?{id:t.id,type:t.type,checked:t.checked||!1,content:t.content||""}:null)}},[r,k,c]);const ce=t=>{o(s=>s.map(a=>a.id===t?w(v({},a),{content:void 0,value:void 0}):a))},Ee=(t,s)=>{var i;const a=(i=t.target.files)==null?void 0:i[0];if(a){const n=new FileReader;n.onloadend=()=>{const u=n.result;o(x=>x.map(b=>b.id===s?w(v({},b),{content:u}):b))},n.readAsDataURL(a)}},pe=()=>A(void 0,null,function*(){if(!f||!f.document_title)return;const t=c.map(({id:i,type:n,content:u,pageNo:x,value:b,position:E,size:B,name:W,fontSize:he,assign:De,checked:Oe})=>({id:i,type:n,pageNo:x,assign:De,size:B,name:W,fontSize:he,position:E,content:u,value:b,checked:Oe})),s=Q.reduce((i,n,u)=>{const x=String(n);return i[u]={email:x,status:"unseen"},i},{}),a={document_title:f.name,document_json_data:JSON.stringify(JSON.stringify(t,null,2)),base_pdf_datad:JSON.stringify(JSON.stringify(M,null,2)),assigned_user_list:JSON.stringify(s,null,2)};try{(yield(yield fetch("/api/method/esign_app.api.update_document",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json()).message.status<300?$.success("Document Updated Successfully",{position:"top-right",autoClose:500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:L}):$.error("Error while updating template",{position:"top-right",autoClose:500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:L})}catch(i){console.error("Error:",i),alert("An error occurred while updating the template")}S(null)});return f?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs flex items-center gap-3 relative p-6 bg-[#283C42] text-white border-2 border-transparent hover:border-[#283C42] transition-colors duration-300",children:[e.jsx("button",{className:"button",onClick:()=>xe(-1),children:e.jsxs("div",{className:"button-box",children:[e.jsx("span",{className:"button-elem",children:e.jsx("svg",{viewBox:"0 0 46 40",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M46 20.038c0-.7-.3-1.5-.8-2.1l-16-17c-1.1-1-3.2-1.4-4.4-.3-1.2 1.1-1.2 3.3 0 4.4l11.3 11.9H3c-1.7 0-3 1.3-3 3s1.3 3 3 3h33.1l-11.3 11.9c-1 1-1.2 3.3 0 4.4 1.2 1.1 3.3.8 4.4-.3l16-17c.5-.5.8-1.1.8-1.9z"})})}),e.jsx("span",{className:"button-elem",children:e.jsx("svg",{viewBox:"0 0 46 40",children:e.jsx("path",{d:"M46 20.038c0-.7-.3-1.5-.8-2.1l-16-17c-1.1-1-3.2-1.4-4.4-.3-1.2 1.1-1.2 3.3 0 4.4l11.3 11.9H3c-1.7 0-3 1.3-3 3s1.3 3 3 3h33.1l-11.3 11.9c-1 1-1.2 3.3 0 4.4 1.2 1.1 3.3.8 4.4-.3l16-17c.5-.5.8-1.1.8-1.9z"})})})]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold",children:f.document_title}),e.jsx("p",{className:"text-sm",children:f.template_title}),e.jsxs("p",{className:"text-sm",children:["Created by: ",f.owner_email]}),e.jsxs("p",{className:"text-sm",children:["Created At: ",ue(f.document_created_at).format("DD/MM/YYYY - HH:mm")," (",ue().to(ue(f.document_created_at)),")"]})]})]}),e.jsxs("div",{className:"templete-main-div relative",children:[e.jsxs("div",{className:"left-area-div h-fit sticky top-0",children:[e.jsxs("div",{className:"control-buttons gap-2 text-xs",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:H,className:"hidden",id:"file-upload"}),e.jsx("label",{htmlFor:"file-upload",className:"items-center content-center space-x-2 bg-[#283C42] text-white px-4 py-2 rounded border-2 border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300 cursor-pointer grid place-items-center",children:e.jsx("span",{children:Y?"Change File":"Upload PDF"})}),e.jsx("button",{className:"bg-[#283C42] text-white px-4 py-2 rounded border-2 border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300",onClick:te,children:"Load Blank Page"}),e.jsx("button",{className:"bg-[#283C42] text-white px-4 py-2 rounded border-2 border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300",onClick:pe,children:"Save Document"}),e.jsx(Ye,{setTarget:S,onClickSaveDoc:pe,owner_email:f.owner_email,assigned_user:Q.map(String),template_tite:f.template_title,document_title:f.name})]}),e.jsx("div",{className:"control-buttons-utilities gap-2 text-xs",children:Ue.map(({type:t,icon:s,title:a})=>e.jsx(le,{type:t,title:a,onClick:()=>ee(t,{top:100,left:100},y),children:s},t))})]}),e.jsxs("div",{className:"templete-app text-xs",children:[e.jsxs("div",{className:"flex gap-3 mb-2",children:[e.jsx("button",{className:"bg-[#283C42] text-white px-4 py-2 rounded border-2 border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300",onClick:F,disabled:y===0,children:"Previous"}),e.jsxs("h1",{className:"mt-2",children:[y+1," / ",M.length]}),e.jsx("button",{className:"bg-[#283C42] text-white px-4 py-2 rounded border-2 border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300",onClick:G,disabled:y===M.length-1,children:"Next"})]}),e.jsxs("div",{className:"workspace",ref:ne(N,oe),onClick:C,children:[e.jsx(Fe,{pdfData:M[y].data}),c.filter(t=>t.pageNo===y).map(t=>{var s,a,i,n;return e.jsxs("div",{"data-id":t.id,className:`component ${t.type} ${r===t.id?"selected":""}`,style:{position:"absolute",top:t.position.top,left:t.position.left,width:(a=(s=t.size)==null?void 0:s.width)!=null?a:0,height:(n=(i=t.size)==null?void 0:i.height)!=null?n:0,border:r===t.id?"1px solid red":"none",fontSize:`${t.fontSize}px`,userSelect:"none",overflow:"hidden"},onClick:u=>{u.stopPropagation(),g(t.id)},children:[t.type==="text"&&e.jsx("div",{style:{width:"100%",height:"100%",overflow:"hidden",fontSize:"inherit",outline:"none"},children:t.value||"Editable Text"}),t.type==="image"&&!t.content&&e.jsx("div",{}),t.type==="v_image"&&!t.content&&e.jsx("div",{}),(t.type==="image"||t.type==="v_image"||t.type==="signature"||t.type==="v_signature")&&t.content&&e.jsx("img",{src:t.content,alt:"Uploaded",style:{width:"100%",height:"100%"}}),t.type==="checkbox"&&e.jsx("input",{type:"checkbox",checked:t.checked||!1,onChange:u=>I(u,t.id)}),t.type==="m_date"&&e.jsx("input",{type:"date",value:t.content||"",onChange:u=>I(u,t.id),readOnly:!0}),t.type==="live_date"&&e.jsx("input",{type:"date",value:new Date().toISOString().split("T")[0],onChange:u=>I(u,t.id),readOnly:!0}),t.type==="fix_date"&&e.jsx("input",{type:"date",value:t.content||"",onChange:u=>I(u,t.id)}),t.type==="v_text"&&e.jsx("div",{children:t.content||"Editable Text"})]},t.id)}),e.jsx(Be,{ref:V,target:k,resizable:!0,draggable:!0,ables:[R],props:{editable:!0},bounds:{left:0,top:0,right:((ge=N.current)==null?void 0:ge.offsetWidth)||0,bottom:((be=N.current)==null?void 0:be.offsetHeight)||0},onDrag:t=>{var b,E;const s=((b=N.current)==null?void 0:b.offsetWidth)||0,a=((E=N.current)==null?void 0:E.offsetHeight)||0,i=t.target.clientWidth||0,n=t.target.clientHeight||0,u=Math.max(0,Math.min(t.top,a-n)),x=Math.max(0,Math.min(t.left,s-i));r!==null&&de(r,u,x)},onResize:t=>{var u,x;const s=((u=N.current)==null?void 0:u.offsetWidth)||0,a=((x=N.current)==null?void 0:x.offsetHeight)||0,i=Math.max(0,Math.min(t.width,s)),n=Math.max(0,Math.min(t.height,a));t.target.style.width=`${i}px`,t.target.style.height=`${n}px`,r!==null&&l(r,i,n)},onScale:t=>{var n,u,x,b,E,B;const s=((n=N.current)==null?void 0:n.offsetWidth)||0,a=((u=N.current)==null?void 0:u.offsetHeight)||0,i=c.find(W=>W.id===r);if(i){const W=Math.max(0,Math.min((b=(x=i.size)==null?void 0:x.width)!=null?b:1*t.scale[0],s)),he=Math.max(0,Math.min((B=(E=i.size)==null?void 0:E.height)!=null?B:1*t.scale[1],a));l(r,W,he)}}})]})]}),e.jsxs("div",{className:"right-templete h-fit sticky top-14",children:[e.jsxs("div",{className:"templete-utility-btn mt-2 text-xs pr-20",children:[r&&((d==null?void 0:d.type)==="image"||(d==null?void 0:d.type)==="v_image")&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:t=>Ee(t,r),className:"hidden",id:"image-upload"}),e.jsxs("label",{htmlFor:"image-upload",className:"flex items-center space-x-2 bg-[#283C42] text-white px-4 py-1 rounded border-2 border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300 cursor-pointer",children:[e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("span",{children:"Upload Image"})]})]}),r&&(d==null?void 0:d.type)==="m_date"&&e.jsx("input",{type:"date",value:d.content||"",onChange:t=>Z(t,r)}),r&&(d==null?void 0:d.type)==="live_date"&&e.jsx("input",{type:"date",value:new Date().toISOString().split("T")[0],readOnly:!0}),r&&(d==null?void 0:d.type)==="fix_date"&&e.jsx("input",{type:"date",value:d.content||"",onChange:t=>Z(t,r)}),r&&((d==null?void 0:d.type)==="text"||(d==null?void 0:d.type)==="v_text")&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"bg-[#283C42] text-white px-4 py-2 rounded border-2 border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300",onClick:()=>T(!0),children:"Increase Text Size"}),e.jsx("button",{className:"bg-[#283C42] text-white px-4 py-2 rounded border-2 border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300",onClick:()=>T(!1),children:"Decrease Text Size"}),e.jsx("button",{className:"bg-[#283C42] text-white px-4 py-2 rounded border-2 border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300",onClick:U,children:"Delete Component"}),e.jsx("input",{className:"bg-[#d1e0e4] text-gray-700 focus:outline-none focus:shadow-outline border border-gray-300 rounded py-2 px-4 block w-full appearance-none",ref:me,type:"text",value:P,onChange:m,placeholder:"Edit text here"})]})]}),r&&(d==null?void 0:d.type)!=="v_text"&&(d==null?void 0:d.type)!=="v_signature"&&(d==null?void 0:d.type)!=="v_image"&&(d==null?void 0:d.type)!=="fix_date"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"templete-utility-btn-add-user flex m-3 gap-3 text-xs pr-10 ml-0",children:[e.jsx("input",{className:"mt-3 bg-[#d1e0e4]  text-gray-700 focus:outline-none focus:shadow-outline border border-gray-300 rounded py-2 px-4 block w-full appearance-none",type:"text",value:j,onChange:X,placeholder:"Add user"}),e.jsx("button",{className:"mt-3  bg-[#283C42] text-white px-4 py-2 rounded border-2 border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300",onClick:re,children:"Add"})]}),e.jsx("div",{children:e.jsx("ul",{className:"list-none p-0 m-0 pr-10",children:(ve=(fe=c.find(t=>t.id===r))==null?void 0:fe.assign)==null?void 0:ve.map((t,s)=>e.jsxs("li",{className:"mr-3 flex items-center justify-between p-2 border-b border-gray-200 hover:bg-gray-100",children:[e.jsx("span",{className:"text-xs text-gray-800 overflow-hidden ",children:t}),e.jsx("button",{onClick:()=>ie(t),className:"flex items-center justify-center w-8 h-8 bg-red-500 text-white rounded-full hover:bg-red-600","aria-label":"Remove user",children:e.jsx("svg",{viewBox:"0 0 1024 1024",fill:"currentColor",height:"1em",width:"1em",children:e.jsx("path",{d:"M678.3 655.4c24.2-13 51.9-20.4 81.4-20.4h.1c3 0 4.4-3.6 2.2-5.6a371.67 371.67 0 00-103.7-65.8c-.4-.2-.8-.3-1.2-.5C719.2 518 759.6 444.7 759.6 362c0-137-110.8-248-247.5-248S264.7 225 264.7 362c0 82.7 40.4 156 102.6 201.1-.4.2-.8.3-1.2.5-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00137 901.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C357 641.2 432.2 610 512.2 610c56.7 0 111.1 15.7 158 45.1a8.1 8.1 0 008.1.3zM512.2 534c-45.8 0-88.9-17.9-121.4-50.4A171.2 171.2 0 01340.5 362c0-45.9 17.9-89.1 50.3-121.6S466.3 190 512.2 190s88.9 17.9 121.4 50.4A171.2 171.2 0 01683.9 362c0 45.9-17.9 89.1-50.3 121.6C601.1 516.1 558 534 512.2 534zM880 772H640c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h240c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"})})})]},s))})})]})]})]}),e.jsx(Ae,{limit:1})]}):e.jsx("div",{children:"No Doc data available"})};export{dt as default};
