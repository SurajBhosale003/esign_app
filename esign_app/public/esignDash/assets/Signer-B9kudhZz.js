var lt=Object.defineProperty,dt=Object.defineProperties;var ct=Object.getOwnPropertyDescriptors;var Ee=Object.getOwnPropertySymbols;var ut=Object.prototype.hasOwnProperty,gt=Object.prototype.propertyIsEnumerable;var De=(h,u,n)=>u in h?lt(h,u,{enumerable:!0,configurable:!0,writable:!0,value:n}):h[u]=n,H=(h,u)=>{for(var n in u||(u={}))ut.call(u,n)&&De(h,n,u[n]);if(Ee)for(var n of Ee(u))gt.call(u,n)&&De(h,n,u[n]);return h},R=(h,u)=>dt(h,ct(u));var N=(h,u,n)=>new Promise((S,d)=>{var f=j=>{try{b(n.next(j))}catch(O){d(O)}},A=j=>{try{b(n.throw(j))}catch(O){d(O)}},b=j=>j.done?S(j.value):Promise.resolve(j.value).then(f,A);b((n=n.apply(h,u)).next())});import{e as ce,f as Pe,r as o,h as ht,j as t,i as pt,u as mt,M as ft}from"./index-B_YNSGLD.js";import{B as ee,Y as te,Q as xt}from"./react-toastify.esm-Dt4eK3tc.js";import{B as yt,P as bt,a as Te,S as wt,r as W,b as $,c as y}from"./BlankPDF-CZRtHREX.js";import{S as Ct}from"./SignPad-DWl9dyq_.js";import{a4 as jt}from"./index-CM3UFs-d.js";import{T as ke}from"./index-CHG0Zyb1.js";import{e as St}from"./extractUniqueElements-Cb8tlYgU.js";import{d as de}from"./dayjsConfig--gnZ1fqe.js";import{C as vt}from"./ConfirmDeleteModal-8k4p4pw2.js";import"./index-CP83d0q4.js";const{TabPane:Ie}=ke,_t=({onSelect:h,onClickbtn:u})=>{const n=ce(Pe);o.useRef(null);const[S,d]=o.useState(!1),[f,A]=o.useState(null),[b,j]=o.useState(null),[O,w]=o.useState([]),[E,B]=o.useState(null),[F,J]=o.useState(!1),se=ce(ht),[ae,V]=o.useState("1"),v=g=>{J(!1),B(g),A(null)},X=g=>{j(g.target.value)},ne=()=>N(void 0,null,function*(){const g={signature_data:E||f,signature_name:b,user_full_name:se,user_email:n};try{const U=yield(yield fetch("/api/method/esign_app.api.save_signature",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)})).json();U.message.status<300?(ee.success("Sign Created Successfully",{position:"top-right",autoClose:500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:te}),A(null),B(null),j(""),J(!0)):alert("Error saving signature: "+U.message)}catch(C){console.error("Error:",C),alert("An error occurred while saving the signature")}V("1")}),D=g=>{J(!1),A(g),B(null)};o.useEffect(()=>{(n||F)&&N(void 0,null,function*(){try{const C=yield fetch(`/api/method/esign_app.api.get_signatures?user_mail=${n}`,{method:"GET",headers:{"Content-Type":"application/json"}}),U=yield C.json();C.status===200&&(w(U.message.data),console.log(`++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
`,U.message.data))}catch(C){}})},[n,F]);const oe=()=>{d(!0),u()},z=()=>{d(!1)},ie=(g,C)=>{h(g,C),z()};return t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"bg-[#283C42] w-full text-white px-4 py-2 rounded border-2 border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300",onClick:oe,children:"Sign"}),t.jsx(jt,{title:"Signature List",open:S,onCancel:z,footer:[,],width:"70vw",children:t.jsx("div",{className:"min-h-[60vh]",children:t.jsxs(ke,{activeKey:ae,onChange:V,children:[t.jsx(Ie,{tab:"All Signatures",children:t.jsx("div",{className:"all-sign-div",children:O.map((g,C)=>t.jsxs("div",{className:"card",onClick:()=>ie(g.sign_blob,g.cert_pem),children:[t.jsx("img",{alt:`Signature ${C}`,src:g.sign_blob,className:"card__image"}),t.jsxs("div",{className:"card__content",children:[t.jsx("p",{className:"card__title",children:g.sign_name}),t.jsx("p",{className:"card__description",children:new Date(g.creation).toLocaleString()})]})]},C))})},"1"),t.jsxs(Ie,{tab:"New Signature",children:[t.jsx(Ct,{onSave:v,onUpload:D}),E&&t.jsxs("div",{className:"bg-gray-200 p-4 mt-4",children:[t.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Signature Preview"}),t.jsx("img",{src:E,alt:"Signature",style:{maxWidth:"100%",height:"90px"},className:"border border-gray-300 rounded"}),t.jsxs("div",{className:"flex items-center space-x-2 mt-2 gap-1",children:[t.jsx("input",{type:"text",className:"border rounded px-4 py-2 h-10 focus:outline-none",placeholder:"Name of Signature",value:b||"",onChange:X}),t.jsx("button",{onClick:ne,className:"bg-white text-[#283C42] px-4 py-2 rounded border-2 border-[#283C42] hover:bg-[#283C42] hover:text-white hover:border-transparent transition-colors duration-300",children:"Save Signature"})]})]}),f&&!E&&t.jsxs("div",{className:"bg-gray-200 p-4 mt-4",children:[t.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Uploaded Image Preview"}),t.jsx("img",{src:f,alt:"Uploaded Image",style:{maxWidth:"100%",height:"auto"},className:"border border-gray-300 rounded"}),t.jsxs("div",{className:"flex items-center space-x-2 mt-2 gap-1",children:[t.jsx("input",{type:"text",className:"border rounded px-4 py-2 focus:outline-none",placeholder:"Name of Signature",onChange:X}),t.jsx("button",{onClick:ne,className:"bg-white text-[#283C42] px-4 py-2 rounded border-2 border-[#283C42] hover:bg-[#283C42] hover:text-white hover:border-transparent transition-colors duration-300",children:"Save Signature"})]})]})]},"2")]})})})]})},Ht=()=>{var me,fe;const[h,u]=o.useState(!1),[n,S]=o.useState([]),[d,f]=o.useState(null),[A,b]=o.useState(null),[j,O]=o.useState("");o.useState("");const[w,E]=o.useState(0),[B,F]=o.useState(null),[J,se]=o.useState([]),[ae,V]=o.useState(!1),[v,X]=o.useState(yt),[ne,D]=o.useState(null),oe=o.useRef(null),z=o.useRef(null),ie=o.useRef(null),g=pt(),[C,U]=o.useState([]),[Y,L]=o.useState(0),{documentData:p}=g.state||{},re=ce(Pe),ue=mt();if(!p)return console.log("No document data",JSON.stringify(p)),t.jsx("p",{children:"Document not found"});o.useEffect(()=>{var e;if(d!==null){const s=n.find(a=>a.id===d);D(s?{id:s.id,type:s.type,checked:(e=s.checked)!=null?e:!1,content:s.content}:null)}},[d,A,n]),o.useEffect(()=>{console.log("Fetch Data before if useEffect  --->>>>>"),Y||(console.log("Fetch Data Inside if isCompleted --->>>>>"),N(void 0,null,function*(){try{console.log("Fetch Data Inside function inside try --->>>>>");const s=yield fetch(`/api/method/esign_app.api.get_assigned_users_list_check?user_document_name=${p.name}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(s.ok){console.log("response Is OK --->>>>>");const a=yield s.json();se(a.message.data.assigned_users||[]);const i=JSON.parse(a.message.data.assigned_users);console.log("here is Assigned user List data",i);const l={unseen:0,open:0,close:0};if(Object.values(i).forEach(m=>{m.status in l&&l[m.status]++}),console.log(l,"-------------------->IMG Count-------------"),l.unseen>0){L(0);return}if(l.open>0){L(0);return}l.open+l.unseen==0&&(L(1),Oe())}else console.error("Error fetching data:",s.statusText)}catch(s){console.error("Fetch error:",s)}finally{}}))},[]);const Oe=()=>N(void 0,null,function*(){console.log("inside updateDocumentStatus");try{const e=yield fetch(`/api/method/esign_app.api.update_document_status_confirm?user_document_name=${p.name}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(e.ok){console.log("inside updateDocumentStatus ------------> OK");const s=yield e.json();console.log(s.message,"Document status updated successfully.",Y)}}catch(e){console.error("Fetch error:",e)}finally{}});o.useEffect(()=>{N(void 0,null,function*(){try{const a=yield(yield fetch(`/api/method/esign_app.api.get_document_components_and_basepdf?document_name=${p?p.name:""}`)).json();if(console.log(a),a.message.document_json_data==null||a.message.base_pdf_datad==null)return;if(a.message.status===200){L(a.message.iscompleted);const i=typeof a.message.document_json_data=="string"?JSON.parse(a.message.document_json_data):a.message.document_json_data,l=typeof a.message.base_pdf_datad=="string"?JSON.parse(a.message.base_pdf_datad):a.message.base_pdf_datad,m=typeof a.message.assigned_users=="string"?JSON.parse(a.message.assigned_users):a.message.assigned_users;F(m),console.log("User Status Document list ------------------>",m);try{for(let T in m)if(m.hasOwnProperty(T)){const x=m[T];if(x.email===re){if(console.log(`Email found at index ${T}, status: ${x.status}`),x.status==="unseen"){x.status="open",m[T]=x,F(m);const le={document_title:p.name,assigned_user_list:JSON.stringify(m)};try{const G=yield(yield fetch("/api/method/esign_app.api.patch_user_status_document",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(le)})).json();console.log(JSON.stringify(G)),G.message.status<300}catch(k){console.error("Error:",k)}}else x.status==="close"&&(u(!0),console.log(`Status: ${x.status}`));break}}}catch(T){}console.log("Parrsed data : ",i),S(i),X(l)}}catch(s){console.error("Error:",s)}}),ge()},[]);const ge=()=>{const e=St(n);U(e)};o.useEffect(()=>{ge()},[n]),o.useEffect(()=>{var e;if(d!==null){const s=n.find(a=>a.id===d);D(s?{id:s.id,type:s.type,checked:(e=s.checked)!=null?e:!1,content:s.content}:null)}},[d,A,n]);const Ue=()=>{w<v.length-1&&(E(w+1),b(null),f(null))},Me=()=>N(void 0,null,function*(){console.log("inside Submit Final Doc");const e={document_title:p.name,document_json_data:JSON.stringify(n)};console.log(e);try{const a=yield(yield fetch("/api/method/esign_app.api.submit_final_document",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();console.log(JSON.stringify(a)),a.message.status<300?(Ve(),ee.success("Document Submitted Successfully",{position:"top-right",autoClose:500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:te}),setTimeout(()=>{ue("/inbox")},1500)):ee.error("Error Submitting Document...",{position:"top-right",autoClose:500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:te})}catch(s){ee.error("Server Error, Please Try Again...",{position:"top-right",autoClose:500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:te})}}),He=()=>{V(!1)},Be=()=>{Me(),V(!1)},Fe=()=>{V(!0)},Ve=()=>{if(B){const e=H({},B);let s=!1;Object.keys(e).forEach(a=>{e[a].email===re&&e[a].status==="open"&&(e[a].status="close",s=!0,F(e),console.log("Updated data of assigned users:",e),ze(e))}),s||console.log('No matching user with "open" status found.')}},ze=e=>N(void 0,null,function*(){const s={document_title:p.name,assigned_user_list:JSON.stringify(e)};try{const i=yield(yield fetch("/api/method/esign_app.api.patch_user_status_document",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json();console.log("API response:",i)}catch(a){console.error("Error sending data to API:",a)}}),Qe=()=>{w>0&&(E(w-1),b(null),f(null))},Re=(e,s)=>{S(a=>a.map(i=>i.id===d?R(H({},i),{content:e,value:e,cert_pem:s}):i)),b(null),f(null),D(null),console.log(`________________________________
`,s)},he=()=>{b(null)},Ge=(e,s)=>{const a=e.target.checked;S(i=>i.map(l=>l.id===s?R(H({},l),{checked:a}):l))},We=(e,s)=>{const a=e.target.value;S(i=>i.map(l=>l.id===s?R(H({},l),{content:a,value:a}):l))},Je=e=>{const s=e.target.value;d!==null&&S(a=>a.map(i=>i.id===d?R(H({},i),{content:s,value:s}):i))},Xe=e=>{e.target.closest(".component")||(f(null),b(null))};o.useEffect(()=>{if(d!==null){const e=document.querySelector(`[data-id="${d}"]`);b(e);const s=n.find(a=>a.id===d);(s==null?void 0:s.type)==="text"&&O(s.content||"")}},[d,n]),o.useEffect(()=>{if(d!==null){const e=n.find(s=>s.id===d);D(e?{id:e.id,type:e.type,checked:e.checked||!1,content:e.content||""}:null)}},[d,A,n]);const pe=e=>Uint8Array.from(atob(e),s=>s.charCodeAt(0)),Ye=(e,s)=>{var i;const a=(i=e.target.files)==null?void 0:i[0];if(a){const l=new FileReader;l.onloadend=()=>{const m=l.result;S(T=>T.map(x=>x.id===s?R(H({},x),{content:m}):x))},l.readAsDataURL(a)}},Le=()=>N(void 0,null,function*(){const e={components:JSON.stringify(n),pages:JSON.stringify(v),private_key_pem:`-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCUjwT+PHfQGSXS
TWFIWn/JlwaLP1cuexz9nfydGNx6FcvP9OAKU+X83f0yCQ2diOknYrISlDxqncu1
dmq8i9exEH84Dui6u5gI9gr8aXClpHu7/fD7hq1zvhGA39NiKxraANpbVM/FhW/9
cV+6YTf3N99SUnp+3NoHTP0m4ogQV+PtgdrcT9sU59c+wLGv1raLURRATeekw7ea
NbwfUeM957iJ7F+4idPVGvfbNkI3nB7oVZu11x5Hhlo2iZf/YhWkeh4rptfzi3Wh
mCXMsV2XTJNC1D1DICSS/j6PJWSE9ViQ8sbM9YsFCPu97iHuRWFhItmbdBSWEYqU
pHsbOd9zAgMBAAECggEAAyMJTXRUaVSmm6FeUlX1iHmuaIakCMtjtNKUW3LYxkvV
27nFeKJbOF2C86laRr8ggTWQd1uhnPS2W59jqJXhWOVKx7xqMKCLw3YCjGA47Ikj
ww1H0d/UTh3aJm5TeylYLfiXo8G6M2cFEtpv1YfTqTOI/SbYXFETL3/yK9MxC/tE
Nq1hCCHzAXJ8sSfUhgb58C2qGG5fFuk/mXnVy+b4dAAaEbfFJfd++nkGjaIbZ+cz
yCEIitJrt1hYVxdFMFHomQYHrCDWrbEF9hmW+BOKj6Rrgo3tFsrbVE8NDQ35ZCky
Fwq/qp85g3ejZXM1PjeboO6iOmSNwjbEjkW2gUEGtQKBgQDH0q4Eq4nBhZktqxIl
bxHQAXK6pe/p4NP/ytaTelYAPNiPWDRyx+AyCHWc7UvIjj3QOQ00ZnWbl9r46Jix
+CpZB6fVcBuEgPkQcEf2RM5m9wwhr4t/+Krg/PQ4EpLkKD3zPpls66jeB0xZQ0WQ
wRuVbrRu4ZPmXpCVLE0Wi/PT/QKBgQC+UtUfsUFXbauwNdMNCOay9VyOraycEUNF
eTUtMc6XEdpFUNO66s8CxcUD3E/YKRYYTAmJKOi7zMtpTUXpthxnX7/+xIOvOsJP
piCJf9ZjpUfoYGw7SuZVh9j/SH3yQyPww0FyyR3JIuR23bQAP3lvGo6jRHnhy71+
evH3FJ4ELwKBgQCOTatACCmCd/IuY7X4krDMwTtDUQkaNdLER1+oh2bXpH1VGCvB
0jYHa57WsudVXHcI4phUyOLYe7ylpn+XvnPqE1mi1sPCCVdWLaAR8c5L5YPuOWXP
LPgEYiBKDnAtq7ryj5ITz3/jHq9wokfYXq2WLdCxZlQ9qvqsQXBkriZmwQKBgCzQ
BhyDOPZj/UPtOHdePCuw+A0kOXs52VQXWPz+OD1715/wixn8xadKd7wT+LzV17z6
0lf4SOxHKTHvHuILnh58/hD3pmXw+OWWIR0e+5TUytydL366gQdsiBx7riQHyQOc
heGIFzpPu+l9BC/2whn179Xjfqs6tLB+NFDQCvDDAoGAP7uSds3lR/MPOmPFedH0
CFUgnk+/l59bw91NHjXG/uGmXC5vhgNzd9mqyS8yZsXxy0tGinaqNSVGFn7XbH1g
e+NjGVrXHUlJKeAe0IFYNgRCodoF5WD5wqpjXrd6cxmnw8OjLwuPWqYrq7hlEeDM
3IlGnTSCUgXEvkdqY0oH8sM=
-----END PRIVATE KEY-----`,certificate_pem:`-----BEGIN CERTIFICATE-----
MIIDCjCCAfKgAwIBAgICA+gwDQYJKoZIhvcNAQELBQAwRjEZMBcGA1UEAwwQU3Vy
YWogUi4gQmhvc2FsZTEQMA4GA1UECgwHU0JTQlNCUzELMAkGA1UEBhMCVVMxCjAI
BgNVBAgMAVMwIhgPMjAyMzExMjYwMDAwMDBaGA8yMDI0MTIyNjAwMDAwMFowRjEZ
MBcGA1UEAwwQU3VyYWogUi4gQmhvc2FsZTEQMA4GA1UECgwHU0JTQlNCUzELMAkG
A1UEBhMCVVMxCjAIBgNVBAgMAVMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEK
AoIBAQCUjwT+PHfQGSXSTWFIWn/JlwaLP1cuexz9nfydGNx6FcvP9OAKU+X83f0y
CQ2diOknYrISlDxqncu1dmq8i9exEH84Dui6u5gI9gr8aXClpHu7/fD7hq1zvhGA
39NiKxraANpbVM/FhW/9cV+6YTf3N99SUnp+3NoHTP0m4ogQV+PtgdrcT9sU59c+
wLGv1raLURRATeekw7eaNbwfUeM957iJ7F+4idPVGvfbNkI3nB7oVZu11x5Hhlo2
iZf/YhWkeh4rptfzi3WhmCXMsV2XTJNC1D1DICSS/j6PJWSE9ViQ8sbM9YsFCPu9
7iHuRWFhItmbdBSWEYqUpHsbOd9zAgMBAAEwDQYJKoZIhvcNAQELBQADggEBAC4I
hjXX/Gg4eExxjTaCJSQ6eiamjZNOCRh6ZuAU8lpNBloB95RgjYHOcMN8TyhJgXLM
1xXhUixTp5xhNyO/0k/AJiN4VS/str+hBShcqbd/Z6NPyV+qxoQbIEUIhEh2ORx6
2Tuyq9Zl0sl23Tjk1Jb2923gUp2ftXnMtYSlk5eEIJoDv/KKAr7Rfw0mrNL+bTro
bDCzzGF8EB/su8hDXkD+rg2sncI64LsGVwjDF2yb7Kuw0AXJYZXo9rg4xGl8yhiT
piax3FWGhW6XlzbOzueu0ydzZxm3sdVSM/mPGQE+YP/AWqGkqg6Ho8NWG/vTZBY5
QieTHQvF9azztycxwOc=
-----END CERTIFICATE-----`};console.log(`


 data: `+JSON.stringify(e)+`


`);try{const a=yield(yield fetch("/api/method/esign_app.api.generate_signed_pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(console.log(`



 data: -----`,JSON.stringify(a)),a.signed_pdf){const i=new Blob([atob(a.signed_pdf)],{type:"application/pdf"}),l=URL.createObjectURL(i);window.open(l)}else console.error(a.error)}catch(s){console.error("Error:",s)}}),qe=()=>N(void 0,null,function*(){var G,xe,ye,be,we,Ce,je,Se;const e=yield Te.create(),s=yield e.embedFont(wt.TimesRoman);for(let c=0;c<v.length;c++){const I=pe(v[c].data),q=yield Te.load(I);(yield e.copyPages(q,q.getPageIndices())).forEach(M=>e.addPage(M))}const a=n.reduce((c,I)=>(c[I.pageNo]||(c[I.pageNo]=[]),c[I.pageNo].push(I),c),{}),i=e.getPages();for(const c of i){const I=i.indexOf(c),q=a[I]||[];for(const r of q){const{left:M,top:K}=r.position;if(r.type==="text"||r.type==="v_text"){const _=(G=r.fontSize)!=null?G:12,P=c.getHeight()-K-_-3;c.drawText(r.content||"",{x:M+3,y:P,size:_,color:W(0,0,0),lineHeight:_*1.2,maxWidth:(ye=(xe=r.size)==null?void 0:xe.width)!=null?ye:0,font:s})}else if((r.type==="image"||r.type==="v_image"||r.type==="v_signature"||r.type==="signature")&&r.content){const _=r.content.split(",")[1];if(!_){console.error("Invalid image data");continue}if(r.type==="signature"){const nt=r.name||"Unknown",ot=new Date().toISOString(),it=$.of(`Certificate: ${r.cert_pem}
Signer: ${nt}
SignedAt: ${ot}`),rt=e.context.obj({Type:y.of("Annot"),Subtype:y.of("Widget"),T:$.of(`Signature_${I}_${r.name}`),Contents:it,Rect:[0,0,0,0],P:c.ref,F:4});let Z=c.node.lookup(y.of("Annots"));Z||(Z=e.context.obj([]),c.node.set(y.of("Annots"),Z)),Z.push(rt),c.node.set(y.of("Group"),e.context.obj({Type:y.of("Group"),S:y.of("Transparency"),CS:y.of("DeviceRGB")})),console.log(`Certificate embedded as annotation for ${r.name}`)}const P=pe(_);let Q;if(r.content.startsWith("data:image/png"))Q=yield e.embedPng(P);else if(r.content.startsWith("data:image/jpeg")||r.content.startsWith("data:image/jpg"))Q=yield e.embedJpg(P);else{console.error("Unsupported image format");continue}const{width:ve,height:_e}=Q,Ke=(we=(be=r.size)==null?void 0:be.width)!=null?we:0,Ze=(je=(Ce=r.size)==null?void 0:Ce.height)!=null?je:0,$e=Ke/ve,et=Ze/_e,Ne=Math.min($e,et),tt=ve*Ne,Ae=_e*Ne,st=M,at=c.getHeight()-K-Ae;c.drawImage(Q,{x:st,y:at,width:tt,height:Ae})}else if(r.type==="checkbox"){const P=c.getHeight()-K-10-5;r.checked?c.drawRectangle({x:M+5,y:P,width:10,height:10,color:W(0,0,0)}):c.drawRectangle({x:M+5,y:P,width:10,height:10,borderColor:W(0,0,0),borderWidth:1,color:W(1,1,1)})}else if(r.type==="m_date"||r.type==="live_date"||r.type==="fix_date"){const _=(Se=r.fontSize)!=null?Se:12,P=c.getHeight()-K-_-3,Q=r.content||new Date().toLocaleDateString();c.drawText(Q,{x:M+3,y:P,size:_,color:W(0,0,0),font:s})}}}e.catalog.set(y.of("OutputIntent"),e.context.obj({Type:y.of("OutputIntent"),S:y.of("GTS_PDFA1"),OutputConditionIdentifier:$.of("sRGB IEC61966-2.1"),Info:$.of("sRGB IEC61966-2.1")}));const l=e.context.obj({Type:y.of("Metadata"),Subtype:y.of("XML"),Length:0});e.catalog.set(y.of("Metadata"),l),e.setTitle("Document signed by eSign"),e.setAuthor("Dexciss Technology"),e.setSubject("eSign"),e.setKeywords(["Dexciss Technology","eSign"]),e.setCreationDate(new Date),e.setModificationDate(new Date);const m=yield e.save(),T=new Blob([m],{type:"application/pdf"}),x=URL.createObjectURL(T),le=`esignDoc-${p.document_title}`,k=document.createElement("a");k.href=x,k.download=`${le}.pdf`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(x)});return p?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"text-xs flex items-center gap-3 relative p-6 bg-[#283C42] text-white border-2 border-transparent hover:border-[#283C42] transition-colors duration-300",children:[t.jsx("div",{children:t.jsx("button",{className:"button",onClick:()=>ue(-1),children:t.jsxs("div",{className:"button-box",children:[t.jsx("span",{className:"button-elem",children:t.jsx("svg",{viewBox:"0 0 46 40",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M46 20.038c0-.7-.3-1.5-.8-2.1l-16-17c-1.1-1-3.2-1.4-4.4-.3-1.2 1.1-1.2 3.3 0 4.4l11.3 11.9H3c-1.7 0-3 1.3-3 3s1.3 3 3 3h33.1l-11.3 11.9c-1 1-1.2 3.3 0 4.4 1.2 1.1 3.3.8 4.4-.3l16-17c.5-.5.8-1.1.8-1.9z"})})}),t.jsx("span",{className:"button-elem",children:t.jsx("svg",{viewBox:"0 0 46 40",children:t.jsx("path",{d:"M46 20.038c0-.7-.3-1.5-.8-2.1l-16-17c-1.1-1-3.2-1.4-4.4-.3-1.2 1.1-1.2 3.3 0 4.4l11.3 11.9H3c-1.7 0-3 1.3-3 3s1.3 3 3 3h33.1l-11.3 11.9c-1 1-1.2 3.3 0 4.4 1.2 1.1 3.3.8 4.4-.3l16-17c.5-.5.8-1.1.8-1.9z"})})})]})})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-bold ",style:{fontVariant:"small-caps"},children:p.document_title}),t.jsx("p",{className:"text-xs",children:p.template_title}),t.jsxs("p",{className:"text-xs",children:["Email: ",p.owner_email]}),t.jsxs("p",{className:"text-sm",children:["Created At: ",de(p.document_created_at).format("DD/MM/YYYY - HH:mm")," (",de().to(de(p.document_created_at)),")"]})]})]}),t.jsxs("div",{className:`${h?"":"templete-main-div-signer"} `,children:[t.jsxs("div",{className:"templete-app text-xs",children:[t.jsxs("div",{className:"flex gap-3 mb-2",children:[t.jsx("button",{className:"bg-[#283C42] text-white px-4 py-2 min-w-[5rem] max-w-[5rem] rounded border-2 border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300",onClick:Qe,disabled:w===0,children:"Previous"}),t.jsxs("h1",{className:"mt-2",children:[w+1," / ",v.length]}),t.jsx("button",{className:"bg-[#283C42] text-white px-4 py-2 rounded border-2 min-w-[5rem] max-w-[5rem] border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300",onClick:Ue,disabled:w===v.length-1,children:"Next"}),Y==1&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"bg-[#283C42] text-white px-4 py-2 rounded border-2  border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300",onClick:qe,children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",height:"1.7em",width:"1.7em",children:t.jsx("path",{d:"M7 10a1 1 0 101 1 1 1 0 00-1-1zm12-4h-1V3a1 1 0 00-1-1H7a1 1 0 00-1 1v3H5a3 3 0 00-3 3v6a3 3 0 003 3h1v3a1 1 0 001 1h10a1 1 0 001-1v-3h1a3 3 0 003-3V9a3 3 0 00-3-3zM8 4h8v2H8zm8 16H8v-4h8zm4-5a1 1 0 01-1 1h-1v-1a1 1 0 00-1-1H7a1 1 0 00-1 1v1H5a1 1 0 01-1-1V9a1 1 0 011-1h14a1 1 0 011 1z"})})}),t.jsx("button",{onClick:Le,children:"click me"})]}),h&&Y==0&&t.jsx("button",{className:"bg-[#283C42] text-white px-4 py-2 cursor-not-allowed rounded border-2  border-transparent transition-colors duration-300",disabled:w===v.length-1,children:t.jsx("svg",{"data-name":"Layer 1",viewBox:"0 0 24 24",fill:"currentColor",height:"1.7em",width:"1.7em",children:t.jsx("path",{d:"M7 10a1 1 0 101 1 1 1 0 00-1-1zM3.71 2.29a1 1 0 00-1.42 1.42L4.62 6A3 3 0 002 9v6a3 3 0 003 3h1v3a1 1 0 001 1h10a1 1 0 001-1v-1.59l2.29 2.3a1 1 0 001.42 0 1 1 0 000-1.42zM6 15v1H5a1 1 0 01-1-1V9a1 1 0 011-1h1.59l6 6H7a1 1 0 00-1 1zm10 5H8v-4h6.59L16 17.41zm3-14h-1V3a1 1 0 00-1-1H8.66a1 1 0 000 2H16v2h-3.34a1 1 0 000 2H19a1 1 0 011 1v6a.37.37 0 010 .11 1 1 0 00.78 1.18h.2a1 1 0 001-.8A2.84 2.84 0 0022 15V9a3 3 0 00-3-3z"})})})]}),t.jsxs("div",{className:"workspace",ref:z,onClick:Xe,children:[t.jsx(bt,{pdfData:v[w].data}),n.filter(e=>e.pageNo===w).map(e=>{var s,a,i,l;return t.jsxs("div",{"data-id":e.id,className:` ${e.type} ${d===e.id?"selected":""}`,style:{position:"absolute",top:e.position.top,left:e.position.left,width:(a=(s=e.size)==null?void 0:s.width)!=null?a:0,height:(l=(i=e.size)==null?void 0:i.height)!=null?l:0,border:d===e.id?"1px solid red":"none",fontSize:`${e.fontSize}px`,userSelect:"none",overflow:"hidden"},onClick:m=>{m.stopPropagation(),f(e.id)},children:[e.type==="text"&&t.jsx("div",{style:{width:"100%",height:"100%",overflow:"hidden",fontSize:"inherit",outline:"none"},children:e.value||"Text Here"}),e.type==="image"&&!e.content&&t.jsx("div",{}),e.type==="v_image"&&!e.content&&t.jsx("div",{}),(e.type==="image"||e.type==="v_image"||e.type==="signature"||e.type==="v_signature")&&e.content&&t.jsx("img",{src:e.content,alt:"Uploaded",style:{width:"100%",height:"100%"}}),e.type==="checkbox"&&t.jsx("input",{type:"checkbox",checked:e.checked||!1,readOnly:!0}),e.type==="m_date"&&t.jsx("input",{type:"date",value:e.content||"",readOnly:!0}),e.type==="live_date"&&t.jsx("input",{type:"date",value:new Date().toISOString().split("T")[0],readOnly:!0}),e.type==="fix_date"&&t.jsx("input",{type:"date",value:e.content||"",readOnly:!0}),e.type==="v_text"&&t.jsx("div",{children:e.content||"Editable Text"})]},e.id)}),t.jsx(ft,{ref:oe,bounds:{left:0,top:0,right:((me=z.current)==null?void 0:me.offsetWidth)||0,bottom:((fe=z.current)==null?void 0:fe.offsetHeight)||0}})]})]}),t.jsxs("div",{className:`right-div-signer p-5 cursor-pointer ${h?"hidden":""}`,children:[t.jsxs("div",{className:"w-full max-w-4xl bg-white rounded-lg shadow-md overflow-hidden ",children:[t.jsx("button",{onClick:Fe,className:"bg-[#283C42] text-white px-4 py-2 mb-4  border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] transition-colors duration-300",children:"Submit"}),t.jsxs("table",{className:"w-full signer-table ",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-[#283C42] text-white",children:[t.jsx("th",{className:"py-3 px-4 text-left",children:"Sr."}),t.jsx("th",{className:"py-3 px-4 text-left",children:"Component"}),t.jsx("th",{className:"py-3 px-4 text-left",children:"Page No."}),t.jsx("th",{className:"py-3 px-4 text-left",children:"Input"})]})}),t.jsx("tbody",{children:n.filter(e=>{var s;return(s=e.assign)==null?void 0:s.includes(re)}).map((e,s)=>t.jsxs("tr",{className:`${d===e.id?"selected-row bg-blue-100":""} ${s%2===0?"bg-gray-50":"bg-white"}`,onClick:()=>{f(e.id),E(e.pageNo),he()},children:[t.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:s+1}),t.jsx("td",{className:"py-2 px-4 border-b border-gray-200",onClick:()=>{f(e.id)},children:e.name}),t.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:e.pageNo+1}),t.jsxs("td",{className:"py-2 px-4 border-b border-gray-200 max-w-[18vw]",children:[e.type==="signature"&&t.jsx(_t,{onSelect:Re,onClickbtn:he}),e.type==="image"&&t.jsx("input",{type:"file",accept:"image/*",onChange:a=>Ye(a,e.id)}),e.type==="checkbox"&&t.jsx("input",{type:"checkbox",checked:e.checked||!1,onChange:a=>Ge(a,e.id)}),(e.type==="m_date"||e.type==="fix_date")&&t.jsx("input",{type:"date",value:e.content||"",onChange:a=>We(a,e.id)}),e.type==="live_date"&&t.jsx("input",{type:"date",value:new Date().toISOString().split("T")[0],readOnly:!0}),e.type==="text"&&t.jsx("input",{className:"bg-[#d1e0e4] text-gray-700 focus:outline-none focus:shadow-outline border border-gray-300 rounded py-2 px-4 block w-full appearance-none",ref:ie,type:"text",value:e.content||"",onClick:()=>{f(e.id),E(e.pageNo)},onChange:Je,placeholder:"Edit text here"})]})]},e.id))})]})]}),t.jsx(vt,{visible:ae,name:p.name,onCancel:He,onConfirm:Be,message:"Are you sure you want to submit this document? After That You Can't Change or Edit Document !",module:"Document Submit"})]})]}),t.jsx(xt,{limit:1})]}):t.jsx("div",{children:"No Doc data available"})};export{Ht as default};
